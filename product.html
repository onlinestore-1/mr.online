<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="refereer" content="strict-origin-when-cross-origin">

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#f4f4f4;
      padding:15px;
    }

    .card{
      background:#fff;
      padding:15px;
      border-radius:8px;
    }

    img{
      width:100%;
      border-radius:6px;
    }

    h2{
      margin:10px 0 5px;
    }

    button{
      width:100%;
      padding:10px;
      margin-top:8px;
      border:none;
      border-radius:5px;
      font-size:16px;
      cursor:pointer;
    }

    .buy{
      background:#ff9f00;
    }

    .cart{
      background:#2874f0;
      color:white;
    }

    input{
      width:60px;
      padding:5px;
      font-size:16px;
    }
  </style>
</head>

<body>

<div class="card" id="productBox">
  <!-- Product loads here -->
</div>

<script>
const products = JSON.parse(localStorage.getItem("allProducts")) || [
  {id:1,name:"Men T-shirt",price:12,img:"https://via.placeholder.com/200",desc:"Cotton T-shirt"},
  {id:2,name:"Dress",price:22,img:"https://via.placeholder.com/200",desc:"Ladies dress"},
  {id:3,name:"Shoes",price:30,img:"https://via.placeholder.com/200",desc:"Running shoes"}
];

const pid = localStorage.getItem("pid");
const p = products.find(x => x.id == pid);

document.getElementById("productBox").innerHTML = `
  <img src="${p.img}">
  <h2>${p.name}</h2>
  <p>${p.desc}</p>
  <b>$${p.price}</b><br><br>

  Qty:
  <input id="qty" type="number" value="1" min="1"><br><br>

  <button class="buy" onclick="buy()">Buy Now</button>
  <button class="cart" onclick="addCart()">Add to Cart</button>
`;

function buy(){
  const qty = document.getElementById("qty").value;
  localStorage.setItem("buy", JSON.stringify({...p, qty}));
  location.href = "checkout.html";
}

function addCart(){
  const qty = document.getElementById("qty").value;
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  cart.push({...p, qty});

  // max 10 items rule
  if(cart.length >= 10){
    cart = [];
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  alert("Added to cart âœ…");
}
</script>

</body>
</html>
