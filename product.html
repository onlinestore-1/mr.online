<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#f4f4f4;
      padding:15px;
    }

    .card{
      background:#fff;
      padding:15px;
      border-radius:8px;
    }

    img{
      width:100%;
      border-radius:6px;
    }

    h2{
      margin:10px 0 5px;
    }

    button{
      width:100%;
      padding:10px;
      margin-top:8px;
      border:none;
      border-radius:5px;
      font-size:16px;
      cursor:pointer;
    }

    .buy{background:#ff9f00;}
    .cart{background:#2874f0;color:white;}

    input{width:60px;padding:5px;font-size:16px;}

    /* YOU MAY ALSO LIKE */
    h3{margin-top:25px;}

    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:10px;
    }

    .mini{
      background:#fff;
      padding:10px;
      border-radius:6px;
      cursor:pointer;
    }

    .mini img{
      width:100%;
      height:120px;
      object-fit:cover;
    }

    .mini p{
      margin:5px 0;
      font-size:14px;
    }
  </style>
</head>

<body>

<div class="card" id="productBox"></div>

<h3>You May Also Like</h3>
<div class="grid" id="likeBox"></div>

<script>
const products = JSON.parse(localStorage.getItem("allProducts")) || [
  {id:1,name:"Men T-shirt",price:12,img:"https://via.placeholder.com/200",desc:"Cotton T-shirt"},
  {id:2,name:"Dress",price:22,img:"https://via.placeholder.com/200",desc:"Ladies dress"},
  {id:3,name:"Shoes",price:30,img:"https://via.placeholder.com/200",desc:"Running shoes"}
];

const pid = localStorage.getItem("pid");
const p = products.find(x => x.id == pid);

// MAIN PRODUCT
document.getElementById("productBox").innerHTML = `
  <img src="${p.img}">
  <h2>${p.name}</h2>
  <p>${p.desc}</p>
  <b>$${p.price}</b><br><br>

  Qty:
  <input id="qty" type="number" value="1" min="1"><br><br>

  <button class="buy" onclick="buy()">Buy Now</button>
  <button class="cart" onclick="addCart()">Add to Cart</button>
`;

// YOU MAY ALSO LIKE (exclude current product)
const likeBox = document.getElementById("likeBox");
products.filter(x => x.id != pid).forEach(p2 => {
  likeBox.innerHTML += `
    <div class="mini" onclick="openProduct(${p2.id})">
      <img src="${p2.img}">
      <p>${p2.name}</p>
      <b>$${p2.price}</b>
    </div>
  `;
});

function openProduct(id){
  localStorage.setItem("pid", id);
  location.reload(); // reload product page with new product
}

function buy(){
  const qty = document.getElementById("qty").value;
  localStorage.setItem("buy", JSON.stringify({...p, qty}));
  location.href = "checkout.html";
}

function addCart(){
  const qty = document.getElementById("qty").value;
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  cart.push({...p, qty});

  if(cart.length >= 10){
    cart = [];
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  alert("Added to cart âœ…");
}
</script>

</body>
</html>
